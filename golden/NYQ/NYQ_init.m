% =========================================================================
% ECE 5746 - Simple Sawtooth Wave Oscillator Model
% (c) 2019 ok93@cornell.edu, ut33@cornell.edu, ll556@cornell.edu
% ===================================================================
function [par,sta] = NYQ_init(par,sta)


FixP_out = {0,23,'s'}; % {I,F,'s'} where 's' is signed
QType_out = 'WrpTrc_NoWarn'; % we wrap and truncate 

sta.NYQ.ins = [];
sta.NYQ.outs = [];

% =========================================================================
% ==============         FILTER COEFFICIENTS          ===================== 
% ============== here we have different sized arrays  =====================
% ============== for the filter coefficients,in order =====================
% ============== to use, comment out all but one lst  =====================
% =========================================================================

% length 16 coeff array:
% x_D = [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.8,0.7,0.6,0.5,0.4,0.3,0.2,0.1]; 

% length 24 coeff array:
% x_D = [0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.5,0.6,0.7,0.8,0.9,0.9,0.8,0.7,0.6,0.5,0.4,0.35,0.3,0.25,0.2,0.15,0.1]; 

% length 32 coeff array:
% x_D = [0.1,0.15,0.2,0.25,0.3,0.35,0.4,0.45, 0.5, 0.55, 0.6,0.65, 0.7,0.75, 0.8,0.9,0.9,0.8,0.75,0.7,0.65,0.6,0.55,0.5,0.45,0.4,0.35,0.3,0.25,0.2,0.15,0.1]; 
% x_D = x_D/sum(x_D);

% length 1024 array
x_D = [1.08566258745833e-05,-8.97057481405328e-06,-6.81748054915728e-06,-5.59642249464742e-06,-4.77758320553618e-06,-4.05791250366985e-06,-3.22898287121508e-06,-2.2287033499661e-06,-1.03677811332085e-06,2.60925866388336e-07,1.574457554031e-06,2.74634838754856e-06,3.65676699473852e-06,4.16047134312081e-06,4.19089905265103e-06,3.68996490416726e-06,2.70367269080196e-06,1.2971291666973e-06,-3.63383443696387e-07,-2.11333531188233e-06,-3.71940152572605e-06,-4.99661712042484e-06,-5.73939424103261e-06,-5.84433028440528e-06,-5.22699676236953e-06,-3.94380847446768e-06,-2.0723758984143e-06,1.54227806605349e-07,2.53828210882811e-06,4.7424154565121e-06,6.52741144271856e-06,7.63531013716616e-06,7.87081173212941e-06,7.16545547670173e-06,5.55670728354391e-06,3.15903712325185e-06,2.29170634743068e-07,-2.91083796974745e-06,-5.87604071619931e-06,-8.31464815055021e-06,-9.88660614749757e-06,-1.03603583766944e-05,-9.59398822996597e-06,-7.6231148199424e-06,-4.60491371720057e-06,-8.64916997076356e-07,3.19890037393628e-06,7.09603097044769e-06,1.03618700512622e-05,1.25482554118809e-05,1.33465583714122e-05,1.25648659365613e-05,1.0229026690834e-05,6.51918353085711e-06,1.8306112938194e-06,-3.33937661428603e-06,-8.37200615048769e-06,-1.26641364156619e-05,-1.56484438928516e-05,-1.68998598649903e-05,-1.61732873849065e-05,-1.34642384529077e-05,-8.98261737394794e-06,-3.19970786089562e-06,3.26670609727811e-06,9.65806604586584e-06,1.52106293338715e-05,1.9195320989461e-05,2.10711047501964e-05,2.04944347369704e-05,1.74288858746496e-05,1.21078080772445e-05,5.08159739653533e-06,-2.89781029682949e-06,-1.08989779957056e-05,-1.79748795697892e-05,-2.32133012873128e-05,-2.59113472052294e-05,-2.56102423363384e-05,-2.222404142678e-05,-1.60044160552399e-05,-7.58570060787342e-06,2.13363766524358e-06,1.20291908786379e-05,2.09298204744272e-05,2.77083976289764e-05,3.14655084181533e-05,3.16046639272768e-05,2.79643025924617e-05,2.08002168639557e-05,1.08380704919197e-05,-8.63867125234567e-07,-1.29595729312095e-05,-2.40259658202043e-05,-3.2674937886459e-05,-3.77812137440977e-05,-3.85648947921548e-05,-3.47655953894765e-05,-2.66337544912504e-05,-1.49802953353799e-05,-1.04150120320866e-06,1.35885730919877e-05,2.71975879316718e-05,3.80965486139485e-05,4.48839170775238e-05,4.65637923393043e-05,4.27432482070211e-05,3.36452024639994e-05,2.01648910884664e-05,3.72954812173845e-06,-1.37946079767633e-05,-3.03644347818777e-05,-4.39431660295993e-05,-5.28011115560773e-05,-5.56793395285267e-05,-5.20183239189214e-05,-4.19873379074035e-05,-2.65604723665255e-05,-7.36137384546362e-06,1.34392403407015e-05,3.34266790896493e-05,5.01637942801012e-05,6.15417056513432e-05,6.59825848505442e-05,6.27132154840718e-05,5.18234870638687e-05,3.43490598536503e-05,1.21227023914157e-05,-1.23556222036177e-05,-3.62570428854823e-05,-5.66884531680294e-05,-7.10969436709032e-05,-7.75282339805949e-05,-7.49430406477321e-05,-6.33130629429229e-05,-4.372042940653e-05,-1.82089559114277e-05,1.03672158715413e-05,3.8717216406291e-05,6.34323548207927e-05,8.14497351457358e-05,9.03688044175221e-05,8.88260634039806e-05,7.66283010047631e-05,5.48822847020137e-05,2.58405426405706e-05,-7.2644250749007e-06,-4.06339805045867e-05,-7.02801289298146e-05,-9.25547887331903e-05,-0.000104537137031591,-0.000104468963741641,-9.19410168988047e-05,-6.80481263036509e-05,-3.52493883814899e-05,2.82215229020181e-06,4.18151429974411e-05,7.70949891494387e-05,0.000104348808519726,0.000120051711814236,0.000121972120744433,0.000109420743644389,8.34430595310949e-05,4.66901945660431e-05,3.21262702491935e-06,-4.20381896357129e-05,-8.37112377718713e-05,-0.000116743304352483,-0.00013691118159777,-0.000141423951087125,-0.000129238210353189,-0.00010129968670993,-6.04316462886213e-05,-1.11147661056055e-05,4.10531168242541e-05,8.9934016286316e-05,0.000129621019640844,0.000155092810127021,0.000162898637239058,0.000151558076958823,0.000121855361231753,7.6757590649868e-05,2.11831433950301e-05,-3.85827037947859e-05,-9.55383145120042e-05,-0.000142837113439546,-0.000174550253635715,-0.000186456774395222,-0.000176540877537493,-0.000145354539465223,-9.59692320090831e-05,-3.3741227247642e-05,3.43167280937194e-05,0.000100265254266655,0.000156214809436093,0.000195208568871749,0.000212135301928955,0.000204334605859118,0.000172039953542025,0.000118378154820962,4.91334180687248e-05,-2.79178729397053e-05,-0.000103824056977546,-0.000169543882043111,-0.00021696581540632,-0.000239954411370111,-0.000235080521528654,-0.000202159729971307,-0.000144311042223754,-6.77301466085058e-05,1.90153498964629e-05,0.000105885552408165,0.000182576758433095,0.000239685829687164,0.00026990655047636,0.000268902843825343,0.00023595824297885,0.000174105968511393,8.99237924051449e-05,-7.20590848123211e-06,-0.000106083610131509,-0.000195027796435343,-0.000263197955157098,-0.000301958289006149,-0.000305911604828938,-0.000273677290156329,-0.000208111873683475,-0.00011613125390573,-7.94649007657182e-06,0.000104013638895478,0.000206571275046542,0.000287294756719793,0.000336047060615686,0.000346198517495874,0.000315555781996442,0.000246687555906493,0.000146791957176874,2.69116057911839e-05,-9.92295489095452e-05,-0.000216837917409947,-0.000311729455149098,-0.00037207917641479,-0.000389836899902186,-0.000361827702068662,-0.000290203349697088,-0.000182370850114187,-5.01965223653418e-05,9.12422269458904e-05,0.000225414183410936,0.000336212797550825,0.000409926219948348,0.000436877210572558,0.000412718997375168,0.000339037544588589,0.000223356325118279,7.83433591263196e-05,-7.95182052309934e-05,-0.000231839363960165,-0.000360412990321146,-0.000449426678759137,-0.000487349811654961,-0.0004684528130801,-0.000393582425900618,-0.00027026639540546,-0.000111936769072196,6.34745247675111e-05,0.00023560030899568,0.000383949419172762,0.000490379727504997,0.000541261307614877,0.000529245435982704,0.000454241894435266,0.000323648040482103,0.00015160476569048,-4.24757007394991e-05,-0.000236130204729092,-0.000406392300127809,-0.000532546995646712,-0.000598596257498066,-0.000595310407997647,-0.000521438153651122,-0.000384085578029857,-0.000198026086666797,1.58273521154493e-05,0.000232802084774486,0.000427258342144117,0.00057564932164718,0.000659317375763704,0.000666861610898277,0.000595615063635723,0.00045220421464398,0.000251936803917927,1.72303966904131e-05,-0.000224922524197291,-0.000446005833809472,-0.000619364833488592,-0.000723366252992297,-0.00074411685008123,-0.000677245775634009,-0.000528680636262588,-0.000314139314761115,-5.75317666647503e-05,0.00021172606413949,0.000462031965169894,0.0006633307442463,0.000790668993099287,0.000827306489530632,0.000766844555919754,0.00061425739421794,0.000385519520870397,0.00010600214917265,-0.000192359814670571,-0.000474661843115127,-0.000707135655979546,-0.000861134654764856,-0.00091667888532915,-0.000864977061872095,-0.000709755717914514,-0.000467060459285331,-0.000163669442278088,0.000165875020931681,0.000483144592178969,0.000750324574997842,0.000934667711403653,0.00101251979311829,0.000972285504145618,0.000816105953324058,0.000559874205509922,0.000231696243578061,-0.000131200321446707,-0.000486634093817405,-0.000792387646939752,-0.00101116728816789,-0.00111516186097362,-0.00108950820078516,-0.000934372850973717,-0.000665230281169388,-0.00031140620144863,8.71208075385061e-05,0.000484178841759171,0.000832762837848047,0.00109054401674524,0.00122501511482206,0.00121752087374121,0.00106580529862267,0.000784608695159914,0.000404334022419155,-3.22356799180772e-05,-0.000474690958920502,-0.000870822582475822,-0.0011727254624653,-0.00134259256816294,-0.00135737957627614,-0.00121189089588747,-0.000919759050144474,-0.000512282902841867,-3.50880544565323e-05,0.000456919339445588,0.000905870228246669,0.00125767970478108,0.00146855867461221,0.00151039175574683,0.0013744436104745,0.00107279617001825,0.00063741634278944,0.00011679290495477,-0.000429396398680795,-0.000937118720012315,-0.00134543074041832,-0.00160378267118822,-0.00167820176437949,-0.00155571285370967,-0.00124631991567107,-0.000782373588073878,-0.000215226498574409,0.000390376852140945,0.000963676108559694,0.00143609560549598,0.00174942828507174,0.00186292774355645,0.00175855363187066,0.00144360096143279,0.00095045009434959,0.000333294386677664,-0.000337733477673819,-0.000984505354717833,-0.00152991988107311,-0.00190706493516836,-0.00206733990356321,-0.00198665548212922,-0.00166883466385654,-0.00114584572014115,-0.000474668593565499,0.000268819366621348,0.00099838248581048,0.00162734530907511,0.00207884776060818,0.00229514113238571,0.00224489830958587,0.0019275342504536,0.00137404887397941,0.000644115125971222,-0.000180243326674807,-0.00100381327587786,-0.00172909168357381,-0.00226776974586472,-0.00255137382650582,-0.00253987496297708,-0.00222711424876331,-0.00164241094970938,-0.000847983060960361,6.75385857516166e-05,0.000998918964133254,0.00183629864439565,0.00247806894577182,0.00284306835394256,0.00288072544552735,0.00257782204124948,0.00196106745521794,0.0010949952662723,7.53810924113683e-05,-0.000981237656221415,-0.00195073626313962,-0.0027158678113847,-0.00318027751396791,-0.00328047800489569,-0.00299424782378797,-0.00234443859484767,-0.00139754269337376,-0.000257114002672862,0.000947399718641795,0.00207516262514768,0.00299025287835909,0.00357783024504131,0.0037583320539753,0.00349790618770263,0.0028138092976661,0.00177392247783978,0.000490325880373345,-0.000892554763386224,-0.00221394534356388,-0.00331517569859804,-0.00405844039849771,-0.00434373708253685,-0.0041218818301179,-0.00340200649960047,-0.00225242632506159,-0.000794612860841549,0.000809305198193034,0.00237421319211319,0.00371301627202336,0.00465858575700455,0.0050841666642122,0.0049197581173364,0.00416246257477093,0.00287933049931299,0.0012021456105248,-0.000685586042860178,-0.00256817199758572,-0.00422181279450744,-0.00544055351705586,-0.00606121016158923,-0.00598429237394192,-0.00518837995653026,-0.00373598054075193,-0.00176988226627971,0.000500012545353777,0.00281821462325868,0.00491145079835731,0.00651977418061363,0.00742758749796095,0.00749097577906541,0.00665808084924266,0.00497982799431208,0.00260935687893243,-0.000210354872831,-0.00316981207679505,-0.00592519810780356,-0.00813622250410857,-0.00950567186988461,-0.00981627860956053,-0.00896066250624578,-0.00696060180927287,-0.00397293183130821,-0.000280645162654617,0.00373064396364636,0.00760916552312735,0.0108831616027624,0.0131123756219412,0.0139396534353024,0.0131372224520775,0.0106424639371293,0.00657887627792427,0.00125921335309527,-0.00483049354814114,-0.011065472627111,-0.0167328150312386,-0.0210939699198434,-0.0234535690852259,-0.0232282019864742,-0.0200085003193921,-0.0136083277270514,-0.00409588443412453,0.00819686862000958,0.0226881175364825,0.038582899213135,0.0549299144868129,0.0706938042528676,0.0848367135829967,0.0964019896873755,0.104592563841671,0.108836961628399,0.108836961628399,0.104592563841671,0.0964019896873755,0.0848367135829967,0.0706938042528676,0.0549299144868129,0.038582899213135,0.0226881175364825,0.00819686862000958,-0.00409588443412453,-0.0136083277270514,-0.0200085003193921,-0.0232282019864742,-0.0234535690852259,-0.0210939699198434,-0.0167328150312386,-0.011065472627111,-0.00483049354814114,0.00125921335309527,0.00657887627792427,0.0106424639371293,0.0131372224520775,0.0139396534353024,0.0131123756219412,0.0108831616027624,0.00760916552312735,0.00373064396364636,-0.000280645162654617,-0.00397293183130821,-0.00696060180927287,-0.00896066250624578,-0.00981627860956053,-0.00950567186988461,-0.00813622250410857,-0.00592519810780356,-0.00316981207679505,-0.000210354872831,0.00260935687893243,0.00497982799431208,0.00665808084924266,0.00749097577906541,0.00742758749796095,0.00651977418061363,0.00491145079835731,0.00281821462325868,0.000500012545353777,-0.00176988226627971,-0.00373598054075193,-0.00518837995653026,-0.00598429237394192,-0.00606121016158923,-0.00544055351705586,-0.00422181279450744,-0.00256817199758572,-0.000685586042860178,0.0012021456105248,0.00287933049931299,0.00416246257477093,0.0049197581173364,0.0050841666642122,0.00465858575700455,0.00371301627202336,0.00237421319211319,0.000809305198193034,-0.000794612860841549,-0.00225242632506159,-0.00340200649960047,-0.0041218818301179,-0.00434373708253685,-0.00405844039849771,-0.00331517569859804,-0.00221394534356388,-0.000892554763386224,0.000490325880373345,0.00177392247783978,0.0028138092976661,0.00349790618770263,0.0037583320539753,0.00357783024504131,0.00299025287835909,0.00207516262514768,0.000947399718641795,-0.000257114002672862,-0.00139754269337376,-0.00234443859484767,-0.00299424782378797,-0.00328047800489569,-0.00318027751396791,-0.0027158678113847,-0.00195073626313962,-0.000981237656221415,7.53810924113683e-05,0.0010949952662723,0.00196106745521794,0.00257782204124948,0.00288072544552735,0.00284306835394256,0.00247806894577182,0.00183629864439565,0.000998918964133254,6.75385857516166e-05,-0.000847983060960361,-0.00164241094970938,-0.00222711424876331,-0.00253987496297708,-0.00255137382650582,-0.00226776974586472,-0.00172909168357381,-0.00100381327587786,-0.000180243326674807,0.000644115125971222,0.00137404887397941,0.0019275342504536,0.00224489830958587,0.00229514113238571,0.00207884776060818,0.00162734530907511,0.00099838248581048,0.000268819366621348,-0.000474668593565499,-0.00114584572014115,-0.00166883466385654,-0.00198665548212922,-0.00206733990356321,-0.00190706493516836,-0.00152991988107311,-0.000984505354717833,-0.000337733477673819,0.000333294386677664,0.00095045009434959,0.00144360096143279,0.00175855363187066,0.00186292774355645,0.00174942828507174,0.00143609560549598,0.000963676108559694,0.000390376852140945,-0.000215226498574409,-0.000782373588073878,-0.00124631991567107,-0.00155571285370967,-0.00167820176437949,-0.00160378267118822,-0.00134543074041832,-0.000937118720012315,-0.000429396398680795,0.00011679290495477,0.00063741634278944,0.00107279617001825,0.0013744436104745,0.00151039175574683,0.00146855867461221,0.00125767970478108,0.000905870228246669,0.000456919339445588,-3.50880544565323e-05,-0.000512282902841867,-0.000919759050144474,-0.00121189089588747,-0.00135737957627614,-0.00134259256816294,-0.0011727254624653,-0.000870822582475822,-0.000474690958920502,-3.22356799180772e-05,0.000404334022419155,0.000784608695159914,0.00106580529862267,0.00121752087374121,0.00122501511482206,0.00109054401674524,0.000832762837848047,0.000484178841759171,8.71208075385061e-05,-0.00031140620144863,-0.000665230281169388,-0.000934372850973717,-0.00108950820078516,-0.00111516186097362,-0.00101116728816789,-0.000792387646939752,-0.000486634093817405,-0.000131200321446707,0.000231696243578061,0.000559874205509922,0.000816105953324058,0.000972285504145618,0.00101251979311829,0.000934667711403653,0.000750324574997842,0.000483144592178969,0.000165875020931681,-0.000163669442278088,-0.000467060459285331,-0.000709755717914514,-0.000864977061872095,-0.00091667888532915,-0.000861134654764856,-0.000707135655979546,-0.000474661843115127,-0.000192359814670571,0.00010600214917265,0.000385519520870397,0.00061425739421794,0.000766844555919754,0.000827306489530632,0.000790668993099287,0.0006633307442463,0.000462031965169894,0.00021172606413949,-5.75317666647503e-05,-0.000314139314761115,-0.000528680636262588,-0.000677245775634009,-0.00074411685008123,-0.000723366252992297,-0.000619364833488592,-0.000446005833809472,-0.000224922524197291,1.72303966904131e-05,0.000251936803917927,0.00045220421464398,0.000595615063635723,0.000666861610898277,0.000659317375763704,0.00057564932164718,0.000427258342144117,0.000232802084774486,1.58273521154493e-05,-0.000198026086666797,-0.000384085578029857,-0.000521438153651122,-0.000595310407997647,-0.000598596257498066,-0.000532546995646712,-0.000406392300127809,-0.000236130204729092,-4.24757007394991e-05,0.00015160476569048,0.000323648040482103,0.000454241894435266,0.000529245435982704,0.000541261307614877,0.000490379727504997,0.000383949419172762,0.00023560030899568,6.34745247675111e-05,-0.000111936769072196,-0.00027026639540546,-0.000393582425900618,-0.0004684528130801,-0.000487349811654961,-0.000449426678759137,-0.000360412990321146,-0.000231839363960165,-7.95182052309934e-05,7.83433591263196e-05,0.000223356325118279,0.000339037544588589,0.000412718997375168,0.000436877210572558,0.000409926219948348,0.000336212797550825,0.000225414183410936,9.12422269458904e-05,-5.01965223653418e-05,-0.000182370850114187,-0.000290203349697088,-0.000361827702068662,-0.000389836899902186,-0.00037207917641479,-0.000311729455149098,-0.000216837917409947,-9.92295489095452e-05,2.69116057911839e-05,0.000146791957176874,0.000246687555906493,0.000315555781996442,0.000346198517495874,0.000336047060615686,0.000287294756719793,0.000206571275046542,0.000104013638895478,-7.94649007657182e-06,-0.00011613125390573,-0.000208111873683475,-0.000273677290156329,-0.000305911604828938,-0.000301958289006149,-0.000263197955157098,-0.000195027796435343,-0.000106083610131509,-7.20590848123211e-06,8.99237924051449e-05,0.000174105968511393,0.00023595824297885,0.000268902843825343,0.00026990655047636,0.000239685829687164,0.000182576758433095,0.000105885552408165,1.90153498964629e-05,-6.77301466085058e-05,-0.000144311042223754,-0.000202159729971307,-0.000235080521528654,-0.000239954411370111,-0.00021696581540632,-0.000169543882043111,-0.000103824056977546,-2.79178729397053e-05,4.91334180687248e-05,0.000118378154820962,0.000172039953542025,0.000204334605859118,0.000212135301928955,0.000195208568871749,0.000156214809436093,0.000100265254266655,3.43167280937194e-05,-3.3741227247642e-05,-9.59692320090831e-05,-0.000145354539465223,-0.000176540877537493,-0.000186456774395222,-0.000174550253635715,-0.000142837113439546,-9.55383145120042e-05,-3.85827037947859e-05,2.11831433950301e-05,7.6757590649868e-05,0.000121855361231753,0.000151558076958823,0.000162898637239058,0.000155092810127021,0.000129621019640844,8.9934016286316e-05,4.10531168242541e-05,-1.11147661056055e-05,-6.04316462886213e-05,-0.00010129968670993,-0.000129238210353189,-0.000141423951087125,-0.00013691118159777,-0.000116743304352483,-8.37112377718713e-05,-4.20381896357129e-05,3.21262702491935e-06,4.66901945660431e-05,8.34430595310949e-05,0.000109420743644389,0.000121972120744433,0.000120051711814236,0.000104348808519726,7.70949891494387e-05,4.18151429974411e-05,2.82215229020181e-06,-3.52493883814899e-05,-6.80481263036509e-05,-9.19410168988047e-05,-0.000104468963741641,-0.000104537137031591,-9.25547887331903e-05,-7.02801289298146e-05,-4.06339805045867e-05,-7.2644250749007e-06,2.58405426405706e-05,5.48822847020137e-05,7.66283010047631e-05,8.88260634039806e-05,9.03688044175221e-05,8.14497351457358e-05,6.34323548207927e-05,3.8717216406291e-05,1.03672158715413e-05,-1.82089559114277e-05,-4.372042940653e-05,-6.33130629429229e-05,-7.49430406477321e-05,-7.75282339805949e-05,-7.10969436709032e-05,-5.66884531680294e-05,-3.62570428854823e-05,-1.23556222036177e-05,1.21227023914157e-05,3.43490598536503e-05,5.18234870638687e-05,6.27132154840718e-05,6.59825848505442e-05,6.15417056513432e-05,5.01637942801012e-05,3.34266790896493e-05,1.34392403407015e-05,-7.36137384546362e-06,-2.65604723665255e-05,-4.19873379074035e-05,-5.20183239189214e-05,-5.56793395285267e-05,-5.28011115560773e-05,-4.39431660295993e-05,-3.03644347818777e-05,-1.37946079767633e-05,3.72954812173845e-06,2.01648910884664e-05,3.36452024639994e-05,4.27432482070211e-05,4.65637923393043e-05,4.48839170775238e-05,3.80965486139485e-05,2.71975879316718e-05,1.35885730919877e-05,-1.04150120320866e-06,-1.49802953353799e-05,-2.66337544912504e-05,-3.47655953894765e-05,-3.85648947921548e-05,-3.77812137440977e-05,-3.2674937886459e-05,-2.40259658202043e-05,-1.29595729312095e-05,-8.63867125234567e-07,1.08380704919197e-05,2.08002168639557e-05,2.79643025924617e-05,3.16046639272768e-05,3.14655084181533e-05,2.77083976289764e-05,2.09298204744272e-05,1.20291908786379e-05,2.13363766524358e-06,-7.58570060787342e-06,-1.60044160552399e-05,-2.222404142678e-05,-2.56102423363384e-05,-2.59113472052294e-05,-2.32133012873128e-05,-1.79748795697892e-05,-1.08989779957056e-05,-2.89781029682949e-06,5.08159739653533e-06,1.21078080772445e-05,1.74288858746496e-05,2.04944347369704e-05,2.10711047501964e-05,1.9195320989461e-05,1.52106293338715e-05,9.65806604586584e-06,3.26670609727811e-06,-3.19970786089562e-06,-8.98261737394794e-06,-1.34642384529077e-05,-1.61732873849065e-05,-1.68998598649903e-05,-1.56484438928516e-05,-1.26641364156619e-05,-8.37200615048769e-06,-3.33937661428603e-06,1.8306112938194e-06,6.51918353085711e-06,1.0229026690834e-05,1.25648659365613e-05,1.33465583714122e-05,1.25482554118809e-05,1.03618700512622e-05,7.09603097044769e-06,3.19890037393628e-06,-8.64916997076356e-07,-4.60491371720057e-06,-7.6231148199424e-06,-9.59398822996597e-06,-1.03603583766944e-05,-9.88660614749757e-06,-8.31464815055021e-06,-5.87604071619931e-06,-2.91083796974745e-06,2.29170634743068e-07,3.15903712325185e-06,5.55670728354391e-06,7.16545547670173e-06,7.87081173212941e-06,7.63531013716616e-06,6.52741144271856e-06,4.7424154565121e-06,2.53828210882811e-06,1.54227806605349e-07,-2.0723758984143e-06,-3.94380847446768e-06,-5.22699676236953e-06,-5.84433028440528e-06,-5.73939424103261e-06,-4.99661712042484e-06,-3.71940152572605e-06,-2.11333531188233e-06,-3.63383443696387e-07,1.2971291666973e-06,2.70367269080196e-06,3.68996490416726e-06,4.19089905265103e-06,4.16047134312081e-06,3.65676699473852e-06,2.74634838754856e-06,1.574457554031e-06,2.60925866388336e-07,-1.03677811332085e-06,-2.2287033499661e-06,-3.22898287121508e-06,-4.05791250366985e-06,-4.77758320553618e-06,-5.59642249464742e-06,-6.81748054915728e-06,-8.97057481405328e-06,1.08566258745833e-05];
x_D = x_D/sum(x_D);

% x_D = [0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1, 0.1, 0.1, 0.1,0.1, 0.1,0.1, 0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1]; 
% x_D = x_D/sum(x_D);

% length 512 coeff array:
% x_D = [0.000974760608716798,-0.000814566382769116,-0.000587439101948538,-0.000446803341385845,-0.000352698343712235,-0.000279332910949315,-0.000212003117801307,-0.00014297151143561,-7.07551353057681e-05,2.79282614021521e-06,7.25526085169485e-05,0.000132809373413279,0.000177065802713278,0.000200547279514387,0.000199663295614572,0.000174122279439677,0.000125655124180849,5.96091116875056e-05,-1.72321075387497e-05,-9.55598614554318e-05,-0.000166461462758403,-0.000220428423734313,-0.000250779114080171,-0.000252008085655159,-0.0002234669876132,-0.000166185286874397,-8.7039455873236e-05,6.92795781244925e-06,0.00010372072882993,0.000192136240015363,0.000262914790039323,0.000302792134668104,0.000310044804600489,0.00028010756806309,0.000214560460906412,0.000120409041238688,8.75251444563616e-06,-0.000109003398165533,-0.00021904244622581,-0.000307559078745625,-0.000362324346232173,-0.000375793059698525,-0.000344916076100867,-0.00027184139818119,-0.000163215644949003,-3.04980966966361e-05,0.000111396113692465,0.000245526279748463,0.000355377628079852,0.000426818021236783,0.000449939117018485,0.000420288336147457,0.000339319686279749,0.000214866390354998,5.97803131827438e-05,-0.000108171429910173,-0.000269962661070207,-0.000405283090212736,-0.000497392390926907,-0.000533546992961923,-0.000506816836567719,-0.000419046711998775,-0.000277689594458926,-9.80224997776918e-05,9.96925566011924e-05,0.000292553425095262,0.000457687300648684,0.000573910995509865,0.000625715842075052,0.000604737676681199,0.000511029335745399,0.000352892317466653,0.000147088579956311,-8.34137671209931e-05,-0.000311810336801547,-0.000510991700603516,-0.000656133594468835,-0.000728049123995096,-0.000715467386676795,-0.00061716451028695,-0.00044197643257179,-0.00020827459951958,5.8123066197223e-05,0.000326618800056991,0.000565076157204841,0.000744245382470917,0.000840416605035771,0.000839803678684438,0.000739088050054782,0.000546994276474945,0.000283619227410963,-2.23333158560568e-05,-0.000335564484666028,-0.000618936073285791,-0.000837779507490927,-0.000963940491934587,-0.000979254202799912,-0.000878556622664113,-0.000670098724295107,-0.000375193553360331,-2.61528950384784e-05,0.000337009608367217,0.000671591932171266,0.000936820454864123,0.00109892191499811,0.00113521687389173,0.00103756803624229,0.000813408097499605,0.000485561185272115,8.96545119896399e-05,-0.000329182452588241,-0.00072185926503934,-0.0010407725913145,-0.00124575052583585,-0.00130896250826477,-0.00121829539527311,-0.000980000669791717,-0.000617699814397936,-0.000170858511568497,0.000309925098659387,0.000768636938308674,0.00114993003097963,0.00140608578670938,0.00150285423716837,0.00142381245758112,0.00117301099925146,0.000775160647471376,0.000273023483697537,-0.000276891614679399,-0.000810594008541549,-0.00126409185458638,-0.00158109574001928,-0.00171970574928787,-0.00165803579080664,-0.00139736609628869,-0.000962701241549757,-0.000400335519520576,0.000226711921565953,0.000845904987216462,0.00138325754054803,0.00177254099022061,0.00196288780089767,0.00192567735872109,0.00165836299799573,0.00118569521681716,0.000557717621125594,-0.000155858570784707,-0.000872747008487381,-0.0015078638084413,-0.00198320672060528,-0.00223730600369586,-0.00223320360048813,-0.00196346329235916,-0.00145185835636715,-0.000751708980509443,5.95954502500677e-05,0.0008891317626284,0.00163888196311656,0.00221722431780696,0.00255008337287879,0.00259015676865732,0.002323368039096,0.0017717278888134,0.000991786529164081,6.89299542049788e-05,-0.000891758285101105,-0.00177728036180273,-0.00248001023912596,-0.00291045092902029,-0.00300866227105189,-0.00275197493139868,-0.00215934230017001,-0.00129004516714532,-0.000238239542944324,0.000877152022915285,0.00192575184075253,0.00278053020663817,0.00333334396365827,0.0035081792338471,0.00327121967486489,0.0026363787488134,0.0016652602523239,0.000461488433022925,-0.000840006213374262,-0.00208797174144045,-0.00313212305593881,-0.00384088276243531,-0.00411768653907351,-0.00391375698511477,-0.00323547857935467,-0.00214572234332814,-0.000758524896619108,0.000772491603384343,0.0022707953745532,0.00355679752318118,0.00446913765786191,0.00488439109534615,0.00473307060651153,0.00401008668759223,0.0027777843988899,0.00116162910083432,-0.000662385564169472,-0.00248601626699243,-0.00409218692675419,-0.00528009491353961,-0.00588952206423463,-0.00582164522974047,-0.00505322950000201,-0.00364287888444722,-0.00172798261693058,0.000487854762669755,0.00275559610038603,0.00480769217038575,0.00638860123098345,0.00728533512193043,0.00735455220303825,0.00654296636132875,0.00489832574061208,0.00256921950393285,-0.000206573171002234,-0.00312478694630254,-0.00584628447909959,-0.00803438590776681,-0.00939391219783367,-0.00970808641776502,-0.00886829162782091,-0.00689372758814031,-0.0039376604345941,-0.000278947090658052,0.00370084789886309,0.00755362016085327,0.0108101553802655,0.0130316933213043,0.0138612460294539,0.0130699778791435,0.0105932257364177,0.00655170455920665,0.00125512919019244,-0.00481334546568518,-0.0110313723430982,-0.016687694104015,-0.0210444414032303,-0.0234060455574894,-0.0231880873828892,-0.0199795288100584,-0.0135922430235074,-0.00409245716064533,0.00818959327436995,0.0226733019370683,0.0385642878230295,0.0549111723918984,0.0706778795034083,0.0848253633229793,0.0963957170111114,0.104590517111302,0.108837319636229,0.108837319636229,0.104590517111302,0.0963957170111114,0.0848253633229793,0.0706778795034083,0.0549111723918984,0.0385642878230295,0.0226733019370683,0.00818959327436995,-0.00409245716064533,-0.0135922430235074,-0.0199795288100584,-0.0231880873828892,-0.0234060455574894,-0.0210444414032303,-0.016687694104015,-0.0110313723430982,-0.00481334546568518,0.00125512919019244,0.00655170455920665,0.0105932257364177,0.0130699778791435,0.0138612460294539,0.0130316933213043,0.0108101553802655,0.00755362016085327,0.00370084789886309,-0.000278947090658052,-0.0039376604345941,-0.00689372758814031,-0.00886829162782091,-0.00970808641776502,-0.00939391219783367,-0.00803438590776681,-0.00584628447909959,-0.00312478694630254,-0.000206573171002234,0.00256921950393285,0.00489832574061208,0.00654296636132875,0.00735455220303825,0.00728533512193043,0.00638860123098345,0.00480769217038575,0.00275559610038603,0.000487854762669755,-0.00172798261693058,-0.00364287888444722,-0.00505322950000201,-0.00582164522974047,-0.00588952206423463,-0.00528009491353961,-0.00409218692675419,-0.00248601626699243,-0.000662385564169472,0.00116162910083432,0.0027777843988899,0.00401008668759223,0.00473307060651153,0.00488439109534615,0.00446913765786191,0.00355679752318118,0.0022707953745532,0.000772491603384343,-0.000758524896619108,-0.00214572234332814,-0.00323547857935467,-0.00391375698511477,-0.00411768653907351,-0.00384088276243531,-0.00313212305593881,-0.00208797174144045,-0.000840006213374262,0.000461488433022925,0.0016652602523239,0.0026363787488134,0.00327121967486489,0.0035081792338471,0.00333334396365827,0.00278053020663817,0.00192575184075253,0.000877152022915285,-0.000238239542944324,-0.00129004516714532,-0.00215934230017001,-0.00275197493139868,-0.00300866227105189,-0.00291045092902029,-0.00248001023912596,-0.00177728036180273,-0.000891758285101105,6.89299542049788e-05,0.000991786529164081,0.0017717278888134,0.002323368039096,0.00259015676865732,0.00255008337287879,0.00221722431780696,0.00163888196311656,0.0008891317626284,5.95954502500677e-05,-0.000751708980509443,-0.00145185835636715,-0.00196346329235916,-0.00223320360048813,-0.00223730600369586,-0.00198320672060528,-0.0015078638084413,-0.000872747008487381,-0.000155858570784707,0.000557717621125594,0.00118569521681716,0.00165836299799573,0.00192567735872109,0.00196288780089767,0.00177254099022061,0.00138325754054803,0.000845904987216462,0.000226711921565953,-0.000400335519520576,-0.000962701241549757,-0.00139736609628869,-0.00165803579080664,-0.00171970574928787,-0.00158109574001928,-0.00126409185458638,-0.000810594008541549,-0.000276891614679399,0.000273023483697537,0.000775160647471376,0.00117301099925146,0.00142381245758112,0.00150285423716837,0.00140608578670938,0.00114993003097963,0.000768636938308674,0.000309925098659387,-0.000170858511568497,-0.000617699814397936,-0.000980000669791717,-0.00121829539527311,-0.00130896250826477,-0.00124575052583585,-0.0010407725913145,-0.00072185926503934,-0.000329182452588241,8.96545119896399e-05,0.000485561185272115,0.000813408097499605,0.00103756803624229,0.00113521687389173,0.00109892191499811,0.000936820454864123,0.000671591932171266,0.000337009608367217,-2.61528950384784e-05,-0.000375193553360331,-0.000670098724295107,-0.000878556622664113,-0.000979254202799912,-0.000963940491934587,-0.000837779507490927,-0.000618936073285791,-0.000335564484666028,-2.23333158560568e-05,0.000283619227410963,0.000546994276474945,0.000739088050054782,0.000839803678684438,0.000840416605035771,0.000744245382470917,0.000565076157204841,0.000326618800056991,5.8123066197223e-05,-0.00020827459951958,-0.00044197643257179,-0.00061716451028695,-0.000715467386676795,-0.000728049123995096,-0.000656133594468835,-0.000510991700603516,-0.000311810336801547,-8.34137671209931e-05,0.000147088579956311,0.000352892317466653,0.000511029335745399,0.000604737676681199,0.000625715842075052,0.000573910995509865,0.000457687300648684,0.000292553425095262,9.96925566011924e-05,-9.80224997776918e-05,-0.000277689594458926,-0.000419046711998775,-0.000506816836567719,-0.000533546992961923,-0.000497392390926907,-0.000405283090212736,-0.000269962661070207,-0.000108171429910173,5.97803131827438e-05,0.000214866390354998,0.000339319686279749,0.000420288336147457,0.000449939117018485,0.000426818021236783,0.000355377628079852,0.000245526279748463,0.000111396113692465,-3.04980966966361e-05,-0.000163215644949003,-0.00027184139818119,-0.000344916076100867,-0.000375793059698525,-0.000362324346232173,-0.000307559078745625,-0.00021904244622581,-0.000109003398165533,8.75251444563616e-06,0.000120409041238688,0.000214560460906412,0.00028010756806309,0.000310044804600489,0.000302792134668104,0.000262914790039323,0.000192136240015363,0.00010372072882993,6.92795781244925e-06,-8.7039455873236e-05,-0.000166185286874397,-0.0002234669876132,-0.000252008085655159,-0.000250779114080171,-0.000220428423734313,-0.000166461462758403,-9.55598614554318e-05,-1.72321075387497e-05,5.96091116875056e-05,0.000125655124180849,0.000174122279439677,0.000199663295614572,0.000200547279514387,0.000177065802713278,0.000132809373413279,7.25526085169485e-05,2.79282614021521e-06,-7.07551353057681e-05,-0.00014297151143561,-0.000212003117801307,-0.000279332910949315,-0.000352698343712235,-0.000446803341385845,-0.000587439101948538,-0.000814566382769116,0.000974760608716798 ];

% =========================================================================
% ==============      QUANTIZE THE FILTER COEFFS     ====================== 
% ============== RealRESIZE all of the filter coeffs ======================
% =========================================================================

for y = 1:length(x_D)
    sta.NYQ.coeff(y) = RealRESIZE(x_D(y), FixP_out,QType_out);
end

% =========================================================================
% ==============          ACC, COUNTER INIT          ====================== 
% =========================================================================

% ACC: The number of multipliers = number of coefficients/oversampling ratio
number_mult_D = length(sta.NYQ.coeff)/(sta.GLO.OSR_DO);
disp(number_mult_D);

% Instantiate the accumulators for each multiplier
sta.NYQ.accumulate_D = zeros(1,number_mult_D);

% Instantiate the enable flip flops, note that the number of ffs here is 
% the number of multipliers - 1, this is because we have ffs between each
% multiplier and we do not need one from the first multiplier and the
% output.

sta.NYQ.temp_D = zeros(1,number_mult_D - 1);


% =========================================================================
% ==============         INSTANTIATE STATE           ====================== 
% ==============         COUNTER AND OUTPUT          ====================== 
% =========================================================================
% Indicates 1 whether new sample at output
sta.NYQ.Valid_DO = 0; 

% hold old input sample
sta.NYQ.Sample_D = 0; 

sta.NYQ.Cnt_D = 0;       % set counter to zero
sta.NYQ.Out_DO = 0;      % old output


% =========================================================================
% ==============            RESIZE STATE             ====================== 
% =========================================================================

% resize using RealRESIZE

sta.NYQ.Sample_D = RealRESIZE(sta.NYQ.Sample_D, FixP_out,QType_out);
sta.NYQ.Valid_DO = RealRESIZE(sta.NYQ.Valid_DO, FixP_out,QType_out); 

sta.NYQ.Cnt_D = RealRESIZE(sta.NYQ.Cnt_D, FixP_out,QType_out);
sta.NYQ.Out_DO = RealRESIZE(sta.NYQ.Out_DO, FixP_out,QType_out);
for i = 1:length(sta.NYQ.temp_D)
    sta.NYQ.temp_D(i) = RealRESIZE(sta.NYQ.temp_D(i), FixP_out,QType_out);
end

for i = 1:length(sta.NYQ.accumulate_D)
    sta.NYQ.accumulate_D(i) = RealRESIZE(sta.NYQ.accumulate_D(i),...
        FixP_out,QType_out);
end



% =========================================================================
% ================         PERFORMANCE CHECKER          =================== 
% =========================================================================
    
sta.NYQ.last_n = zeros(1, length(sta.NYQ.coeff));
sta.NYQ.S = [];
sta.NYQ.denom = zeros(1, length(sta.NYQ.coeff));
sta.NYQ.performance_checker = [];
for i = 1: length(sta.NYQ.coeff)
    sta.NYQ.denom(i) = 1;
end
sta.NYQ.filt_out = [];

end